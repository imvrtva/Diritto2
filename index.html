<!doctype html>
<html lang="it">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Luma ‚Äî Corsi di Digital Marketing & Comunicazione</title>
  <meta name="description" content="Luma: e-commerce di corsi su Digital Marketing e Comunicazione. Impara SEO, Social, Performance, Brand, Copy e molto altro." />
  <style>
    :root{
      --bg: #0b0c0f;
      --surface: #111318;
      --muted: #a6adbb;
      --text: #e7e9ee;
      --brand: #7c5cff; /* viola Luma */
      --brand-2:#27e1a1; /* accento */
      --stroke:#20242d;
      --ok:#27e1a1;
      --warn:#ffc861;
      --danger:#ff6b6b;
      --shadow: 0 10px 30px rgba(0,0,0,.35);
      --radius: 14px;
      --radius-sm: 10px;
      --radius-xs: 8px;
      color-scheme: dark light;
    }
    @media (prefers-color-scheme: light) {
      :root{
        --bg: #f6f7fb;
        --surface: #ffffff;
        --muted: #5b6472;
        --text: #0b0c0f;
        --stroke:#e7e9ee;
        --shadow: 0 16px 36px rgba(13, 18, 30, .08);
      }
    }
    [data-theme="light"]{
      --bg: #f6f7fb;
      --surface: #ffffff;
      --muted: #5b6472;
      --text: #0b0c0f;
      --stroke:#e7e9ee;
      --shadow: 0 16px 36px rgba(13, 18, 30, .08);
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font: 16px/1.6 system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Noto Sans", "Apple Color Emoji","Segoe UI Emoji";
      background: var(--bg);
      color: var(--text);
      letter-spacing:.2px;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }
    a{color:inherit;text-decoration:none}
    img{max-width:100%;height:auto;display:block}
    .container{max-width:1200px;margin-inline:auto;padding:0 20px}
    .btn{
      display:inline-flex;align-items:center;gap:.6rem;
      background:var(--brand); color:#fff; border:none; border-radius:999px;
      padding:.85rem 1.2rem; font-weight:700; cursor:pointer;
      box-shadow: var(--shadow);
      transition: transform .12s ease, filter .2s ease, box-shadow .2s ease;
    }
    .btn:hover{transform:translateY(-1px); filter:saturate(1.05)}
    .btn:active{transform:translateY(0)}
    .btn.ghost{
      background:transparent; color:var(--text); border:1px solid var(--stroke);
      box-shadow:none;
    }
    .chip{
      display:inline-flex;align-items:center;gap:.5rem;
      border:1px solid var(--stroke); padding:.4rem .7rem; border-radius:999px;
      font-size:.85rem; color:var(--muted);
      background:var(--surface);
    }
    /* Header */
    header{
      position:sticky; top:0; z-index:50; backdrop-filter:saturate(1.3) blur(8px);
      background: color-mix(in srgb, var(--bg) 80%, transparent);
      border-bottom:1px solid var(--stroke);
    }
    .nav{
      display:flex; align-items:center; justify-content:space-between; gap:16px; padding:12px 0;
    }
    .brand{
      display:flex; align-items:center; gap:.7rem; font-weight:900; letter-spacing:.8px;
    }
    .logo{
      width:36px;height:36px;border-radius:10px;display:grid;place-items:center;
      background: radial-gradient(120% 120% at 20% 20%, var(--brand) 0%, #5d3cff 40%, #2a1f74 100%);
      color:white; font-weight:900;
      box-shadow: var(--shadow);
    }
    nav ul{display:flex; gap:1rem; list-style:none; padding:0; margin:0; align-items:center}
    nav a{padding:.55rem .8rem; border-radius:10px; color:var(--muted)}
    nav a:hover{background:var(--surface); color:var(--text)}
    .actions{display:flex; gap:.5rem; align-items:center}
    .icon-btn{
      width:40px;height:40px;display:grid;place-items:center;border-radius:10px;
      border:1px solid var(--stroke); background:var(--surface); cursor:pointer;
    }
    .menu-toggle{display:none}
    @media (max-width: 900px){
      nav ul{display:none}
      .menu-toggle{display:grid}
    }
    /* Mobile menu */
    .mobile-menu{
      position:fixed; inset:64px 0 auto 0; background:var(--surface);
      border-bottom:1px solid var(--stroke); transform:translateY(-110%); transition:.25s ease;
      z-index:40;
    }
    .mobile-menu.open{transform:translateY(0)}
    .mobile-menu ul{list-style:none; margin:0; padding:10px 20px}
    .mobile-menu a{display:block;padding:14px;border-radius:10px;color:var(--text)}
    .mobile-menu a:hover{background:color-mix(in srgb, var(--brand) 12%, transparent)}
    /* Hero */
    .hero{
      position:relative; padding:64px 0 24px; overflow:hidden;
    }
    .hero-grid{
      display:grid; grid-template-columns:1.2fr .8fr; gap:32px; align-items:center;
    }
    .headline{
      font-size: clamp(28px, 4vw, 52px); line-height:1.1; font-weight:900; letter-spacing:.2px;
    }
    .sub{
      color:var(--muted); max-width:55ch; margin-top:10px;
    }
    .hero-cta{display:flex; gap:12px; margin-top:20px; flex-wrap:wrap}
    .hero-card{
      background: radial-gradient(120% 140% at 10% 10%, color-mix(in srgb, var(--brand) 16%, transparent) 0%, transparent 50%),
                  var(--surface);
      border:1px solid var(--stroke); padding:20px; border-radius:var(--radius); display:grid; gap:12px;
    }
    .stat-badges{display:flex; gap:8px; flex-wrap:wrap}
    .hero-media{
      aspect-ratio: 4/3; border-radius:var(--radius); border:1px solid var(--stroke); overflow:hidden;
      background:
        radial-gradient(55% 80% at 75% 20%, color-mix(in srgb, var(--brand) 18%, transparent), transparent 60%),
        linear-gradient(180deg, color-mix(in srgb, var(--surface) 85%, transparent), var(--surface));
      display:grid; place-items:center; position:relative;
    }
    .demo-chart{
      width:86%; height:70%; border-radius:12px; border:1px dashed var(--stroke);
      display:grid; place-items:center; color:var(--muted); font-weight:700;
    }
    .floating{
      position:absolute; bottom:10%; right:8%;
      background:var(--surface); border:1px solid var(--stroke); border-radius:12px; padding:10px 12px;
      box-shadow: var(--shadow); font-size:.9rem;
    }
    @media (max-width: 900px){
      .hero-grid{grid-template-columns:1fr; gap:18px}
    }
    /* Search + filters */
    .toolbar{
      margin-top:24px; display:flex; gap:12px; align-items:center; flex-wrap:wrap;
      background:var(--surface); border:1px solid var(--stroke); border-radius:999px; padding:10px 12px;
    }
    .toolbar input[type="search"]{
      all:unset; flex:1; padding:8px 10px; border-radius:999px; color:var(--text)
    }
    .filters{display:flex; gap:8px; flex-wrap:wrap}
    .filters button{cursor:pointer}
    /* Sections */
    section{padding:28px 0}
    .section-head{display:flex; justify-content:space-between; align-items:end; gap:16px; margin-bottom:16px}
    .section-head h2{margin:0; font-size: clamp(22px, 2.4vw, 32px)}
    .muted{color:var(--muted)}
    /* Cards */
    .grid{
      display:grid; grid-template-columns: repeat(3, 1fr); gap:16px;
    }
    @media (max-width: 1000px){ .grid{grid-template-columns: repeat(2, 1fr)} }
    @media (max-width: 640px){ .grid{grid-template-columns: 1fr} }
    .card{
      border:1px solid var(--stroke); border-radius:var(--radius-sm); overflow:hidden; background:var(--surface);
      display:grid; grid-template-rows: auto 1fr auto;
      transition: transform .12s ease, box-shadow .25s ease;
    }
    .card:hover{transform:translateY(-2px); box-shadow: var(--shadow)}
    .card-media{
      aspect-ratio: 16/9; background:linear-gradient(120deg, color-mix(in srgb, var(--brand) 20%, transparent), transparent),
                                      linear-gradient(180deg, #0001, transparent);
      display:grid; place-items:center; color:var(--muted); font-weight:700;
    }
    .card-body{padding:14px 14px 0}
    .card-title{margin:0 0 6px; font-weight:800}
    .card-meta{display:flex; gap:10px; align-items:center; color:var(--muted); font-size:.9rem}
    .price{margin-left:auto; font-weight:800; color:var(--text)}
    .rating{display:inline-flex; gap:2px; align-items:center}
    .star{width:14px;height:14px}
    .card-tags{display:flex; gap:6px; flex-wrap:wrap; margin-top:8px}
    .card-footer{
      padding:12px 14px; display:flex; gap:8px; justify-content:space-between; align-items:center; border-top:1px solid var(--stroke)
    }
    .add{font-weight:800}
    .add small{font-weight:600; color:var(--muted)}
    /* Feature row */
    .features{
      display:grid; grid-template-columns: repeat(4, 1fr); gap:14px;
    }
    @media (max-width: 900px){ .features{grid-template-columns: repeat(2, 1fr)} }
    @media (max-width: 520px){ .features{grid-template-columns: 1fr} }
    .feature{
      border:1px solid var(--stroke); border-radius:var(--radius-sm); background:var(--surface); padding:16px; display:grid; gap:8px
    }
    .feature .ico{
      width:36px; height:36px; border-radius:10px; display:grid; place-items:center;
      background: color-mix(in srgb, var(--brand) 20%, transparent);
      border:1px solid var(--stroke);
    }
    /* Testimonials */
    .testi{
      display:grid; grid-template-columns: repeat(3, 1fr); gap:16px;
    }
    @media (max-width: 900px){ .testi{grid-template-columns:1fr} }
    .quote{
      border:1px solid var(--stroke); border-radius:var(--radius-sm); background:var(--surface);
      padding:16px; display:grid; gap:10px
    }
    blockquote{margin:0}
    /* Newsletter */
    .newsletter{
      border:1px dashed var(--stroke); background: color-mix(in srgb, var(--brand) 10%, transparent);
      border-radius:var(--radius); padding:18px; display:grid; gap:10px
    }
    .newsletter form{display:flex; gap:8px; flex-wrap:wrap}
    .newsletter input{
      flex:1; min-width:220px; border:1px solid var(--stroke); border-radius:999px; padding:.8rem 1rem; background:var(--surface);
      color:var(--text);
    }
    /* Footer */
    footer{
      margin-top:30px; padding:34px 0; border-top:1px solid var(--stroke);
      color:var(--muted); font-size:.95rem;
    }
    .foot-grid{
      display:grid; grid-template-columns: 2fr 1fr 1fr 1fr; gap:14px;
    }
    @media (max-width: 900px){ .foot-grid{grid-template-columns:1fr 1fr} }
    @media (max-width: 520px){ .foot-grid{grid-template-columns:1fr} }
    .foot-col h4{margin:0 0 10px; color:var(--text)}
    .foot-col a{display:block; padding:6px 0}
    .credits{margin-top:14px; border-top:1px solid var(--stroke); padding-top:14px; display:flex; gap:10px; justify-content:space-between; flex-wrap:wrap}
    /* Cart (drawer) */
    .cart{
      position:fixed; top:0; right:0; height:100dvh; width:min(420px, 100%);
      transform: translateX(110%); transition:.25s ease; background:var(--surface); border-left:1px solid var(--stroke); z-index:70;
      display:grid; grid-template-rows: auto 1fr auto;
    }
    .cart.open{transform:translateX(0)}
    .cart-head{padding:14px; display:flex; justify-content:space-between; align-items:center; border-bottom:1px solid var(--stroke)}
    .cart-list{overflow:auto}
    .cart-item{display:grid; grid-template-columns:60px 1fr auto; gap:10px; align-items:center; padding:12px 14px; border-bottom:1px solid var(--stroke)}
    .thumb{width:60px; aspect-ratio:1; border-radius:10px; background:linear-gradient(120deg, color-mix(in srgb, var(--brand) 20%, transparent), transparent);}
    .cart-foot{padding:14px; border-top:1px solid var(--stroke); display:grid; gap:10px}
    .row{display:flex; justify-content:space-between; align-items:center}
    .empty{color:var(--muted); text-align:center; padding:32px}
    /* Back to top */
    #toTop{
      position:fixed; right:16px; bottom:16px; z-index:60; opacity:0; pointer-events:none; transition:.2s ease;
    }
    #toTop.show{opacity:1; pointer-events:auto}
    /* Focus visible */
    :focus-visible{outline:2px solid var(--brand-2); outline-offset:3px; border-radius:8px}
  </style>
</head>
<body>
  <!-- Header -->
  <header aria-label="Barra di navigazione">
    <div class="container nav">
      <a class="brand" href="#">
        <span class="logo" aria-hidden="true">L</span>
        <span aria-label="Luma, home">Luma</span>
        <span class="chip" title="Formazione verificata">‚úîÔ∏é Certificata</span>
      </a>
      <div class="actions">
        <button id="themeToggle" class="icon-btn" aria-label="Cambia tema" title="Tema chiaro/scuro">üåì</button>
        <button id="openCart" class="icon-btn" aria-label="Apri carrello" title="Carrello">üõí</button>
        <button class="menu-toggle icon-btn" id="menuBtn" aria-expanded="false" aria-controls="mobileMenu" aria-label="Apri men√π">‚ò∞</button>
      </div>
    </div>
  </header>

  <!-- Hero -->
  <section class="hero">
    <div class="container hero-grid">
      <div>
        <div class="chip">üöÄ Impara oggi, applica domani</div>
        <h1 class="headline">Diventa protagonista del tuo <span style="background:linear-gradient(90deg,var(--brand),var(--brand-2));-webkit-background-clip:text;background-clip:text;color:transparent">Digital Marketing</span>.</h1>
        <p class="sub">Corsi pratici e aggiornati su SEO, Social Ads, Brand Strategy, Copywriting, Analytics e molto altro. Con progetti reali, tutor e certificazione Luma.</p>
        <div class="hero-cta">
          <a class="btn" href="#corsi">Sfoglia i corsi ‚Üí</a>
          <a class="btn ghost" href="#percorsi" aria-label="Vai ai percorsi di studio">Percorsi guidati</a>
        </div>

        <div class="toolbar" role="search" aria-label="Cerca corsi">
          <input id="search" type="search" placeholder="Cerca: SEO, TikTok Ads, Brand..." aria-label="Cerca corsi" />
          <div class="filters" aria-label="Filtra per categoria">
            <button class="chip filter is-active" data-filter="tutto">Tutto</button>
            <button class="chip filter" data-filter="Performance">Performance</button>
            <button class="chip filter" data-filter="Content">Content</button>
            <button class="chip filter" data-filter="Brand">Brand</button>
            <button class="chip filter" data-filter="Analytics">Analytics</button>
          </div>
        </div>
      </div>

      <div class="hero-media" aria-hidden="true">
        <div class="demo-chart">Anteprima dashboard campagne</div>
        <div class="floating">‚è±Ô∏è <b>3‚Äì6h</b> per corso ‚Ä¢ üìÑ Certificato</div>
      </div>
    </div>
  </section>

  <section>
    <div class="container features" aria-label="Punti di forza">
      <div class="feature">
        <div class="ico">üéØ</div>
        <strong>Pratico e subito applicabile</strong>
        <span class="muted">Esempi reali, template e checklist operative.</span>
      </div>
      <div class="feature">
        <div class="ico">üìà</div>
        <strong>Orientato ai risultati</strong>
        <span class="muted">Impara a pianificare, misurare e ottimizzare.</span>
      </div>
      <div class="feature">
        <div class="ico">üßë‚Äçüè´</div>
        <strong>Tutor e community</strong>
        <span class="muted">Supporto continuo e feedback sui progetti.</span>
      </div>
      <div class="feature">
        <div class="ico">üîí</div>
        <strong>Pagamento sicuro</strong>
        <span class="muted">Protezione acquisti e fattura immediata.</span>
      </div>
    </div>
  </section>

  <!-- Corsi -->
  <section id="corsi">
    <div class="container">
      <div class="section-head">
        <div>
          <h2>I corsi pi√π scelti</h2>
          <div class="muted">Aggiornati e orientati al mercato</div>
        </div>
        <a class="btn ghost" href="#corsi">Vedi tutti</a>
      </div>

      <div id="courseGrid" class="grid" aria-live="polite">
        <!-- Cards generate via JS -->
      </div>
    </div>
  </section>

  <!-- Percorsi -->
  <section id="percorsi">
    <div class="container">
      <div class="section-head">
        <div>
          <h2>Percorsi di apprendimento</h2>
          <div class="muted">Roadmap guidate per obiettivi chiari</div>
        </div>
      </div>
      <div class="grid">
        <article class="card">
          <div class="card-media">üß≠ Growth Starter</div>
          <div class="card-body">
            <h3 class="card-title">Growth Starter (4 corsi)</h3>
            <p class="muted">Le basi solide: SEO, Social organico, Email e Analytics per impostare una strategia completa.</p>
            <div class="card-tags">
              <span class="chip">SEO</span><span class="chip">Social</span><span class="chip">Email</span>
            </div>
          </div>
          <div class="card-footer">
            <span class="price">‚Ç¨229</span>
            <button class="btn add" data-bundle="Growth Starter">Aggiungi</button>
          </div>
        </article>

        <article class="card">
          <div class="card-media">‚ö° Performance Pro</div>
          <div class="card-body">
            <h3 class="card-title">Performance Pro (5 corsi)</h3>
            <p class="muted">Paid Social, Google Ads, CRO e attribuzione: porta risultati misurabili su budget reali.</p>
            <div class="card-tags">
              <span class="chip">Ads</span><span class="chip">CRO</span><span class="chip">Attribution</span>
            </div>
          </div>
          <div class="card-footer">
            <span class="price">‚Ç¨349</span>
            <button class="btn add" data-bundle="Performance Pro">Aggiungi</button>
          </div>
        </article>

        <article class="card">
          <div class="card-media">ü™Ñ Brand & Content</div>
          <div class="card-body">
            <h3 class="card-title">Brand & Content (3 corsi)</h3>
            <p class="muted">Brand strategy, storytelling e content system multi-piattaforma.</p>
            <div class="card-tags">
              <span class="chip">Brand</span><span class="chip">Story</span><span class="chip">Content</span>
            </div>
          </div>
          <div class="card-footer">
            <span class="price">‚Ç¨269</span>
            <button class="btn add" data-bundle="Brand & Content">Aggiungi</button>
          </div>
        </article>
      </div>
    </div>
  </section>

  <!-- Testimonianze -->
  <section id="testimonianze">
    <div class="container">
      <div class="section-head">
        <div>
          <h2>Cosa dicono gli studenti</h2>
          <div class="muted">+10.000 iscritti soddisfatti</div>
        </div>
      </div>
      <div class="testi">
        <figure class="quote">
          <blockquote>‚ÄúHo lanciato le mie prime campagne profittevoli dopo 2 settimane. Struttura chiarissima e tanti esempi.‚Äù</blockquote>
          <figcaption class="muted">‚Äî Giulia, Social Media Specialist</figcaption>
        </figure>
        <figure class="quote">
          <blockquote>‚ÄúFinalmente Analytics spiegato in modo pratico. I template sono oro.‚Äù</blockquote>
          <figcaption class="muted">‚Äî Marco, e-commerce manager</figcaption>
        </figure>
        <figure class="quote">
          <blockquote>‚ÄúPercorsi ben pensati: ho costruito il mio portfolio e trovato lavoro in agenzia.‚Äù</blockquote>
          <figcaption class="muted">‚Äî Sara, Junior Performance</figcaption>
        </figure>
      </div>
    </div>
  </section>

  <!-- Newsletter -->
  <section id="newsletter">
    <div class="container newsletter" aria-label="Iscrizione newsletter">
      <div class="chip">üì¨ Rimani aggiornato</div>
      <h2 style="margin:6px 0 0">Risorse gratuite & sconti esclusivi</h2>
      <p class="muted" style="margin:0">Iscriviti per ricevere guide, checklist e early access ai nuovi corsi.</p>
      <form onsubmit="event.preventDefault(); alert('Grazie! Controlla la tua casella email.'); this.reset()">
        <input type="email" required placeholder="La tua email" aria-label="Inserisci la tua email" />
        <button class="btn">Iscrivimi ‚Üí</button>
      </form>
    </div>
  </section>

  <!-- Footer -->
<footer>
  <div class="container foot-grid">
    <div class="foot-col">
      <div class="brand"><span class="logo">L</span><strong>Luma</strong></div>
      <p class="muted">Formazione concreta per chi vuole crescere nel Digital Marketing e nella Comunicazione.</p>
    </div>
    <div class="foot-col">
      <h4>Corsi</h4>
      <a href="#corsi">SEO</a>
      <a href="#corsi">Social Ads</a>
      <a href="#corsi">Brand</a>
      <a href="#corsi">Analytics</a>
    </div>
    <div class="foot-col">
      <h4>Aziende</h4>
      <a href="#">Formazione team</a>
      <a href="#">Workshop</a>
      <a href="#">Consulenza</a>
    </div>
    <div class="foot-col">
      <h4>Legal</h4>
      <a href="#">Privacy</a>
      <a href="#">Termini</a>
      <a href="#">Rimborsi</a>
    </div>
  </div>

  <div class="container legal-info">
    <p>
      <strong>Luma S.R.L.S.</strong> ‚Äì Sede legale: Fondamenta Rimpeto Mocenigo 2068, Venezia<br>
      Contatti: <a href="mailto:marketing@luma.com">marketing@luma.com</a> ‚Äì Tel: 041 8725435<br>
      P.IVA: 12345670987 ‚Äì Iscrizione REA: VE-4398127 ‚Äì Foro competente: Venezia
    </p>
  </div>

  <div class="container credits">
    <span>¬©Ô∏è <span id="year"></span> Luma</span>
    <span>Made with ‚ô•Ô∏è</span>
  </div>
</footer>


  <!-- Cart drawer -->
  <aside class="cart" id="cart" aria-label="Carrello" aria-hidden="true">
    <div class="cart-head">
      <strong>Carrello</strong>
      <button class="icon-btn" id="closeCart" aria-label="Chiudi carrello">‚úï</button>
    </div>
    <div class="cart-list" id="cartList">
      <div class="empty">Il carrello √® vuoto.</div>
    </div>
    <div class="cart-foot">
      <div class="row"><span>Totale</span><strong id="cartTotal">‚Ç¨0</strong></div>
      <button class="btn" id="checkoutBtn">Checkout ‚Üí</button>
      <small class="muted">Pagamenti sicuri ‚Ä¢ Certificazione inclusa</small>
    </div>
  </aside>

  <!-- Back to top -->
  <button id="toTop" class="btn icon" aria-label="Torna su">‚Üë</button>

  <script>
    // ====== DATA (mock) ======
    const COURSES = [
      {id:'seo-found', title:'SEO Foundations', cat:'Performance', hours:5, rating:4.8, ratings:312, price:79, tag:['SEO','On-page','Keyword']},
      {id:'ads-meta', title:'Meta Ads Bootcamp', cat:'Performance', hours:6, rating:4.7, ratings:201, price:99, tag:['Facebook','Instagram','ROAS']},
      {id:'brand-strategy', title:'Brand Strategy Essentials', cat:'Brand', hours:4, rating:4.9, ratings:168, price:89, tag:['Positioning','Identity']},
      {id:'copy-conv', title:'Copywriting per la Conversione', cat:'Content', hours:3, rating:4.8, ratings:289, price:69, tag:['Landing','CRO']},
      {id:'tiktok-org', title:'TikTok Organic System', cat:'Content', hours:3, rating:4.6, ratings:142, price:59, tag:['Shorts','UGC']},
      {id:'ga4', title:'GA4 e Attribution Basics', cat:'Analytics', hours:4, rating:4.6, ratings:120, price:79, tag:['Tracking','KPI']},
      {id:'email-pro', title:'Email Marketing Pro', cat:'Performance', hours:4, rating:4.7, ratings:88, price:69, tag:['Automation','CRM']},
      {id:'linkedin-brand', title:'LinkedIn Personal Brand', cat:'Brand', hours:3, rating:4.5, ratings:77, price:49, tag:['Networking','Authority']},
      {id:'content-system', title:'Content System 2.0', cat:'Content', hours:5, rating:4.8, ratings:230, price:89, tag:['Pillar','Repurpose']},
    ];

    // ====== STATE ======
    const state = {
      query: '',
      filter: 'tutto',
      cart: JSON.parse(localStorage.getItem('luma_cart') || '[]'),
      theme: localStorage.getItem('luma_theme') || (window.matchMedia('(prefers-color-scheme: light)').matches ? 'light' : 'dark')
    };

    // ====== HELPERS ======
    const fmtPrice = n => '‚Ç¨' + n.toLocaleString('it-IT', { minimumFractionDigits: 0 });
    const starSVG = () => `<svg class="star" viewBox="0 0 24 24" aria-hidden="true"><path fill="currentColor" d="M12 17.27 18.18 21l-1.64-7.03L22 9.24l-7.19-.62L12 2 9.19 8.62 2 9.24l5.46 4.73L5.82 21z"/></svg>`;
    const el = sel => document.querySelector(sel);

    // ====== RENDER COURSES ======
    function renderCourses(){
      const grid = el('#courseGrid');
      const q = state.query.trim().toLowerCase();
      const f = state.filter;
      const res = COURSES.filter(c => (f === 'tutto' || c.cat === f) &&
        (!q || c.title.toLowerCase().includes(q) || c.tag.join(' ').toLowerCase().includes(q)));

      grid.innerHTML = res.map(c => `
        <article class="card" data-id="${c.id}" data-cat="${c.cat}">
          <div class="card-media" aria-hidden="true">
            ${c.cat === 'Performance' ? 'üì£' : c.cat === 'Brand' ? '‚ú®' : c.cat === 'Analytics' ? 'üìä' : 'üìù'}
          </div>
          <div class="card-body">
            <h3 class="card-title">${c.title}</h3>
            <div class="card-meta" aria-label="Dettagli corso">
              <span>‚è± ${c.hours}h</span>
              <span class="rating" title="${c.rating} su 5">
                ${starSVG().repeat(5)}
              </span>
              <span class="muted">(${c.ratings})</span>
              <span class="price">${fmtPrice(c.price)}</span>
            </div>
            <div class="card-tags">
              ${c.tag.map(t => `<span class="chip">${t}</span>`).join('')}
            </div>
          </div>
          <div class="card-footer">
            <button class="btn add" data-id="${c.id}" aria-label="Aggiungi ${c.title} al carrello">Aggiungi</button>
            <button class="btn ghost" aria-label="Dettagli ${c.title}">Dettagli</button>
          </div>
        </article>
      `).join('') || `<div class="empty">Nessun corso trovato. Prova a cambiare ricerca o filtro.</div>`;

      // Regola visibilit√† stelle in base al rating
      const ratingsEls = grid.querySelectorAll('.rating');
      ratingsEls.forEach((rEl, idx) => {
        const c = res[idx];
        if (!c) return;
        const full = Math.round(c.rating);
        const stars = rEl.querySelectorAll('.star');
        stars.forEach((s, i) => {
          s.style.opacity = (i < full ? '1' : '0.28');
        });
      });
    }

    // ====== CART ======
    function saveCart(){ localStorage.setItem('luma_cart', JSON.stringify(state.cart)); }
    function addToCartById(id, type='course'){
      const existing = state.cart.find(x => x.id === id && x.type === type);
      if (existing) {
        existing.qty += 1;
      } else {
        let data;
        if (type === 'bundle') {
          // definisci qui i prezzi dei bundle
          const bundlePrices = {
            'Growth Starter': 229,
            'Performance Pro': 349,
            'Brand & Content': 269
          };
          data = {
            title: id,
            price: bundlePrices[id] || 0
          };
        } else {
          data = COURSES.find(c => c.id === id);
        }
        if (!data) return;
        state.cart.push({ id, type, title: data.title, price: data.price, qty: 1 });
      }
      renderCart();
      saveCart();
    }
    function removeFromCart(idx){
      state.cart.splice(idx, 1);
      renderCart();
      saveCart();
    }
    function cartTotal(){
      return state.cart.reduce((sum, it) => sum + it.price * it.qty, 0);
    }
    function renderCart(){
      const list = el('#cartList');
      if (state.cart.length === 0) {
        list.innerHTML = `<div class="empty">Il carrello √® vuoto.</div>`;
        el('#cartTotal').textContent = '‚Ç¨0';
        return;
      }
      list.innerHTML = state.cart.map((it, idx) => `
        <div class="cart-item">
          <div class="thumb" aria-hidden="true"></div>
          <div>
            <strong>${it.title}</strong>
            <div class="muted">x ${it.qty}</div>
          </div>
          <div style="text-align:right">
            <div>${fmtPrice(it.price * it.qty)}</div>
            <button class="chip" aria-label="Rimuovi" onclick="removeFromCart(${idx})">Rimuovi</button>
          </div>
        </div>
      `).join('');
      el('#cartTotal').textContent = fmtPrice(cartTotal());
    }
    window.removeFromCart = removeFromCart;

    // ====== THEME ======
    function applyTheme(){
      if (state.theme === 'light') {
        document.documentElement.setAttribute('data-theme', 'light');
      } else {
        document.documentElement.removeAttribute('data-theme');
      }
      localStorage.setItem('luma_theme', state.theme);
    }

    // ====== SETUP & EVENTI ======
    document.addEventListener('DOMContentLoaded', () => {
      // anno nel footer
      el('#year').textContent = new Date().getFullYear();

      // tema iniziale
      applyTheme();
      el('#themeToggle').addEventListener('click', () => {
        state.theme = (state.theme === 'light' ? 'dark' : 'light');
        applyTheme();
      });

      // menu mobile
      const menuBtn = el('#menuBtn');
      const mobile = el('#mobileMenu');
      menuBtn.addEventListener('click', () => {
        const open = mobile.classList.toggle('open');
        menuBtn.setAttribute('aria-expanded', open);
      });
      mobile.querySelectorAll('a').forEach(a => {
        a.addEventListener('click', () => {
          mobile.classList.remove('open');
          menuBtn.setAttribute('aria-expanded', 'false');
        });
      });

      // ricerca input
      el('#search').addEventListener('input', e => {
        state.query = e.target.value;
        renderCourses();
      });

      // filtri
      document.querySelectorAll('.filter').forEach(btn => {
        btn.addEventListener('click', () => {
          document.querySelectorAll('.filter').forEach(b => b.classList.remove('is-active'));
          btn.classList.add('is-active');
          state.filter = btn.dataset.filter;
          renderCourses();
        });
      });

      // render corsi iniziali
      renderCourses();

      // delega ‚ÄúAggiungi al carrello‚Äù per corsi
      el('#courseGrid').addEventListener('click', (e) => {
        const add = e.target.closest('.add');
        if (add && add.dataset.id) {
          addToCartById(add.dataset.id, 'course');
          openCart();
        }
      });
      // aggiungi bundle
      document.querySelectorAll('[data-bundle]').forEach(b => {
        b.addEventListener('click', () => {
          addToCartById(b.dataset.bundle, 'bundle');
          openCart();
        });
      });

      // carrello open/close
      const cart = el('#cart');
      el('#openCart').addEventListener('click', openCart);
      el('#closeCart').addEventListener('click', closeCart);
      function openCart() {
        cart.classList.add('open');
        cart.setAttribute('aria-hidden', 'false');
      }
      function closeCart() {
        cart.classList.remove('open');
        cart.setAttribute('aria-hidden', 'true');
      }
      window.openCart = openCart;

      // render cart da storage
      renderCart();

      // checkout (demo)
      el('#checkoutBtn').addEventListener('click', () => {
        if (state.cart.length === 0) {
          alert('Aggiungi qualcosa al carrello üòÑ');
          return;
        }
        alert('Checkout demo: ' + fmtPrice(cartTotal()) + '\n(qui integrerai il pagamento reale)');
      });

      // ‚ÄúTorna su‚Äù
      const toTop = el('#toTop');
      window.addEventListener('scroll', () => {
        if (window.scrollY > 400) toTop.classList.add('show');
        else toTop.classList.remove('show');
      });
      toTop.addEventListener('click', () => window.scrollTo({ top: 0, behavior: 'smooth' }));
    });
  </script>
</body>
</html>
