<!doctype html>
<html lang="it">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Luma ‚Äî Checkout</title>
<link rel="stylesheet" href="style.css">
<meta name="description" content="Pagina di acquisto Luma: completa i dati, accetta i termini e procedi al pagamento." />
<style>
  :root{
    --bg: #0b0d12;
    --paper: #0f131a;
    --ink: #e9edf5;
    --muted:#a4aec3;
    --brand:#7c5cff;
    --accent:#27e1a1;
    --stroke:#1e2432;
    --radius:16px;
    --radius-sm:12px;
    --shadow: 0 20px 60px rgba(0,0,0,.35);
    color-scheme: dark;
  }
  @media (prefers-color-scheme: light){
    :root{
      --bg:#f6f7fb; --paper:#ffffff; --ink:#0c0f16; --muted:#5a6376; --stroke:#e6e9f2;
      --shadow: 0 22px 50px rgba(18,22,40,.08);
      color-scheme: light;
    }
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0;
    background:
      radial-gradient(80% 60% at 85% -10%, color-mix(in srgb, var(--brand) 16%, transparent), transparent 60%),
      radial-gradient(60% 50% at 0% 0%, color-mix(in srgb, var(--accent) 12%, transparent), transparent 60%),
      var(--bg);
    color:var(--ink);
    font: 16px/1.75 Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, Arial;
    -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale;
    letter-spacing:.2px;
  }
  a{color:inherit;text-decoration:none}
  .wrap{max-width:1100px;margin-inline:auto;padding:24px clamp(16px,4vw,28px)}

  /* header */
  header[aria-label="Barra di navigazione"]{
    position:sticky; top:0; z-index:50;
    backdrop-filter:saturate(1.2) blur(8px);
    background: color-mix(in srgb, var(--bg) 78%, transparent);
    border-bottom:1px solid var(--stroke);
  }
  .nav{display:flex;align-items:center;justify-content:space-between;gap:12px;min-height:64px}
  .brand{display:flex;align-items:center;gap:.7rem;font-weight:900}
  .logo{width:36px;height:36px;border-radius:12px;display:grid;place-items:center;color:#fff;background:
        radial-gradient(120% 120% at 20% 20%, var(--brand), #5b3cff 45%, #241a70 100%); box-shadow:var(--shadow)}
  .btn{display:inline-flex;align-items:center;gap:.6rem;border:1px solid var(--stroke);border-radius:12px;padding:.7rem 1rem}
  .btn.primary{background:linear-gradient(90deg,var(--brand),color-mix(in srgb,var(--brand) 60%,var(--accent)));color:#0b0f15;border:none}
  .btn.block{width:100%; justify-content:center; font-weight:800}
  .btn:disabled{opacity:.6; cursor:not-allowed}

  /* layout */
  .grid{
    display:grid; grid-template-columns: 1.1fr .9fr; gap:20px; align-items:start; margin-top:14px;
  }
  @media (max-width: 960px){ .grid{grid-template-columns:1fr} }

  .card{
    background:var(--paper); border:1px solid var(--stroke); border-radius:var(--radius);
    box-shadow:var(--shadow);
  }
  .card h2{margin:0; font-size:1.25rem}
  .card-head{padding:18px; border-bottom:1px solid var(--stroke); display:flex; align-items:center; justify-content:space-between}
  .card-body{padding:16px}
  .muted{color:var(--muted)}

  /* stepper */
  .stepper{display:flex; gap:10px; flex-wrap:wrap}
  .chip{display:inline-flex;align-items:center;gap:.45rem;border:1px solid var(--stroke);border-radius:999px;padding:.35rem .65rem}

  /* order summary */
  .item{
    display:grid; grid-template-columns: 64px 1fr auto;
    gap:12px; align-items:center;
    padding:10px 0; border-bottom:1px solid var(--stroke)
  }
  .item:last-child{border-bottom:none}
  .thumb{
    width:64px; aspect-ratio:1; border-radius:12px;
    background-size:cover;
    background-position:center;
    box-shadow:var(--shadow);
  }
  .price{font-weight:800}
  .row{display:flex; justify-content:space-between; align-items:center; gap:10px}
  .total{font-size:1.15rem}
  .code{display:flex; gap:8px}
  .code input{flex:1; min-width:0}

  /* forms */
  form{display:grid; gap:16px}
  fieldset{border:1px solid var(--stroke); border-radius:var(--radius-sm); padding:14px}
  legend{padding:0 6px; color:var(--muted)}
  .fields{display:grid; grid-template-columns: repeat(2, 1fr); gap:10px}
  @media (max-width: 640px){ .fields{grid-template-columns:1fr} }
  label{font-size:.95rem; color:var(--muted); display:block; margin:0 0 4px}
  input, select{
    width:100%; padding:.8rem .9rem; border-radius:12px; border:1px solid var(--stroke);
    background:var(--paper); color:var(--ink);
  }
  input:invalid[aria-invalid="true"]{outline:2px solid #ff6b6b; outline-offset:2px}
  .terms{display:flex; align-items:flex-start; gap:.6rem; font-size:.95rem}
  .terms input{margin-top:.3rem}
  .help{font-size:.9rem; color:var(--muted)}
  .sep{height:1px;background:var(--stroke); margin:10px 0}

  /* footer mini */
  .foot{margin-top:16px;color:var(--muted);display:flex;gap:10px;flex-wrap:wrap;justify-content:space-between}
  .foot a{text-decoration:underline dotted}

  /* focus */
  :focus-visible{outline:2px solid var(--accent); outline-offset:3px; border-radius:8px}
</style>
</head>
<body>
  <!-- HEADER -->
  <header aria-label="Barra di navigazione">
    <div class="container nav">
      <a class="brand" href="index.html">
        <img src="luma4.png" alt="Logo di Luma" class="logo" />
        <span aria-label="Luma, home">Luma</span>
        <span class="chip" title="Formazione verificata">‚úîÔ∏é Certificata</span>
      </a>

      <nav aria-label="Primaria">
        <ul>
          <li><a href="index.html">Corsi</a></li>
          <li><a href="chi-siamo.html">Chi siamo</a></li>
          <li><a href="faq.html">FAQ</a></li>
        </ul>
      </nav>

      <div class="actions">
        <button class="menu-toggle icon-btn" id="menuBtn" aria-expanded="false" aria-controls="mobileMenu" aria-label="Apri men√π">‚ò∞</button>
      </div>
    </div>

    <!-- barra secondaria sotto header -->
    <div class="container header-ribbon">
      <span class="chip">üöÄ Impara oggi, applica domani</span>
      <span class="chip">+10.000 studenti</span>
      <span class="chip">üìÑ Certificazione inclusa</span>
    </div>
  </header>

  <main class="wrap">
    <!-- STEP INTRO -->
    <div class="card">
      <div class="card-head">
        <h2>Checkout</h2>
        <div class="stepper">
          <span class="chip">1 ‚Ä¢ Dati</span>
          <span class="chip">2 ‚Ä¢ Termini</span>
          <span class="chip">3 ‚Ä¢ Pagamento</span>
          <span class="chip">4 ‚Ä¢ Conferma</span>
        </div>
      </div>
    </div>

    <div class="grid">
      <!-- COL SX: FORM -->
      <section class="card" aria-labelledby="dati">
        <div class="card-head"><h2 id="dati">Dati cliente & fatturazione</h2></div>
        <div class="card-body">
          <form id="checkoutForm" novalidate>
            <fieldset>
              <legend>Informazioni personali</legend>
              <div class="fields">
                <div>
                  <label for="name">Nome e Cognome</label>
                  <input id="name" name="name" autocomplete="name" required placeholder="Es. Marta Cazzin" />
                </div>
                <div>
                  <label for="email">Email</label>
                  <input id="email" name="email" type="email" autocomplete="email" required placeholder="tuo@email.it" />
                </div>
                <div>
                  <label for="country">Paese</label>
                  <select id="country" name="country" required>
                    <option value="">Seleziona‚Ä¶</option>
                    <option value="IT">Italia</option>
                    <option value="SM">San Marino</option>
                    <option value="VA">Citt√† del Vaticano</option>
                    <option value="EU">Altro UE</option>
                    <option value="EX">Extra UE</option>
                  </select>
                </div>
                <div>
                  <label for="phone">Telefono (opz.)</label>
                  <input id="phone" name="phone" type="tel" autocomplete="tel" placeholder="+39 3..." />
                </div>
              </div>
            </fieldset>

            <fieldset>
              <legend>Indirizzo di fatturazione</legend>
              <div class="fields">
                <div>
                  <label for="address">Indirizzo</label>
                  <input id="address" name="address" autocomplete="address-line1" required placeholder="Via / Fondamenta‚Ä¶" />
                </div>
                <div>
                  <label for="city">Citt√†</label>
                  <input id="city" name="city" autocomplete="address-level2" required placeholder="Venezia" />
                </div>
                <div>
                  <label for="zip">CAP</label>
                  <input id="zip" name="zip" inputmode="numeric" pattern="\\d{4,6}" required placeholder="30100" />
                  <div class="help">4‚Äì6 cifre</div>
                </div>
                <div>
                  <label for="vat">Partita IVA (se professionista)</label>
                  <input id="vat" name="vat" placeholder="IT12345678901" />
                </div>
              </div>
            </fieldset>

            <section class="form-section">
              <h3 style="margin:0 0 .5rem;font-size:1rem;color:var(--ink);font-weight:600;">Termini &amp; consensi</h3>

              <div class="terms">
                <input id="accept" type="checkbox" name="tc" required aria-describedby="tc-desc">
                <span id="tc-desc">
                  Dichiaro di aver letto e accettato i
                  <a href="termini.html" target="_blank" rel="noopener">Termini &amp; Condizioni</a>
                  di acquisto e la
                  <a href="privacy.html" target="_blank" rel="noopener">Privacy Policy</a>.
                  Senza accettazione non puoi procedere al pagamento.
                </span>
              </div>

              <div class="terms">
                <input type="checkbox" name="marketing_optin">
                <span>Desidero ricevere aggiornamenti e risorse gratuite (facoltativo).</span>
              </div>
            </section>

            <!-- PAGAMENTO -->
            <fieldset id="payBox" aria-disabled="true" disabled>
              <legend>Pagamento</legend>
              <div class="fields">
                <div>
                  <label for="paymethod">Metodo</label>
                  <select id="paymethod" required>
                    <option value="">Scegli‚Ä¶</option>
                    <option value="card">Carta (Visa/Mastercard)</option>
                    <option value="paypal">PayPal</option>
                    <option value="bank">Bonifico</option>
                  </select>
                </div>
                <div data-pay="card">
                  <label for="ccnum">Numero carta</label>
                  <input id="ccnum" inputmode="numeric" pattern="\\d{12,19}" placeholder="1234 5678 9012 3456" />
                </div>
                <div data-pay="card">
                  <label for="exp">Scadenza (MM/AA)</label>
                  <input id="exp" placeholder="08/28" pattern="^(0[1-9]|1[0-2])\\/(\\d{2})$" />
                </div>
                <div data-pay="card">
                  <label for="cvv">CVV</label>
                  <input id="cvv" inputmode="numeric" pattern="\\d{3,4}" placeholder="123" />
                </div>
              </div>
              <div class="sep"></div>
              <button id="payBtn" class="btn primary block" disabled>Paga e Acquista</button>
              <div class="help">Demo: nessun addebito reale. Integra il tuo gateway (Stripe/PayPal) lato server.</div>
            </fieldset>
          </form>
        </div>
      </section>

      <!-- COL DX: ORDER SUMMARY -->
      <aside class="card" aria-labelledby="riepilogo">
        <div class="card-head"><h2 id="riepilogo">Riepilogo ordine</h2></div>
        <div class="card-body">
          <div id="items"><!-- riempiamo via JS --></div>

          <div class="sep"></div>

          <div class="code">
            <input id="coupon" placeholder="Codice sconto" aria-label="Inserisci codice sconto" />
            <button class="btn" id="apply" type="button">Applica</button>
          </div>

          <div class="sep"></div>

          <div class="row"><span>Subtotale</span><strong id="sub">‚Ç¨0,00</strong></div>
<div class="row"><span>IVA (22%)</span><strong id="vat">‚Ç¨0,00</strong></div>
<div class="row total"><span>Totale</span><strong id="tot">‚Ç¨0,00</strong></div>

          <p class="help">Fatturazione immediata. Accesso ai contenuti entro 24h dal pagamento.</p>
        </div>
      </aside>
    </div>

    <div class="foot">
      <span>Serve aiuto? <a href="mailto:hello@marketingluma.com">hello@marketingluma.com</a></span>
      <span><a href="termini.html" target="_blank" rel="noopener">Termini</a> ¬∑ <a href="privacy.html" target="_blank" rel="noopener">Privacy</a></span>
    </div>

  <footer>
    <div class="container foot-grid">
      <div class="foot-col">
        <img src="luma4.png" alt="Logo di Luma" class="logo">
        <p class="muted">Formazione concreta per chi vuole crescere nel Digital Marketing e nella Comunicazione.</p>
      </div>
      <div class="foot-col">
        <h4>Corsi</h4>
        <a href="#consigliati">Percorsi</a>
        <a href="#percorsi">Bundle</a>
        <a href="quiz.html">Trova il tuo corso</a>
      </div>
      <div class="foot-col">
        <h4>Legal</h4>
        <a href="faq.html">FAQ</a>
        <a href="termini.html">Termini</a>
        <a href="#">Privacy</a>
      </div>
    </div>

    <div class="container legal-info">
      <p>
        <strong>Luma S.R.L.S.</strong> ‚Äì Sede legale: Fondamenta Rimpeto Mocenigo 2068, Venezia<br>
        Contatti: <a href="mailto:marketing@luma.com">marketing@luma.com</a> ‚Äì Tel: 041 8725435<br>
        P.IVA: 12345670987 ‚Äì Iscrizione REA: VE-4398127 ‚Äì Foro competente: Venezia
      </p>
    </div>

    <div class="container credits">
      <span>¬©Ô∏è <span id="year"></span> Luma</span>
      <span>Made with ‚ô•Ô∏è</span>
    </div>
  </footer>
  </main>

<script>
document.addEventListener("DOMContentLoaded", () => {
  /* ============================
     UTILS
     ============================ */
  const fmtEuro = new Intl.NumberFormat("it-IT", {
    style: "currency",
    currency: "EUR",
    minimumFractionDigits: 2,
    maximumFractionDigits: 2
  });

  function parseParams() {
    const params = new URLSearchParams(window.location.search);

    // se non c'√® il titolo vuol dire che siamo arrivati senza query
    if (!params.get("title")) {
      return null;
    }

    return {
      id: params.get("id") || "corso-selezionato",
      title: params.get("title"),
      durata: params.get("durata") || "Corso on-demand",
      prezzo: Number(params.get("prezzo") || 0)
    };
  }

  /* ============================
     STATO CARRELLO
     ============================ */
  let cartItem = parseParams();

  // fallback se arrivo "a mano" senza querystring
  if (!cartItem || isNaN(cartItem.prezzo)) {
    cartItem = {
      id: "brand",
      title: "Brand Strategy Essentials",
      durata: "Corso on-demand ‚Ä¢ 4h ‚Ä¢ Certificato",
      prezzo: 89
    };
  }

  /* ============================
     MAPPATURA ID ‚Üí IMMAGINE
     ============================ */
  function getThumbFor(id) {
    switch (id) {
      case "ads":
        return "take1.jpg";
      case "adsprint":
        return "take3.jpg";
      case "launch":
        return "take4.jpg";
      case "brand":
        return "take5.jpg";
      case "content":
        return "take6.jpg";
      default:
        return "take5.jpg"; // fallback safe
    }
  }

  /* ============================
     RENDER RIEPILOGO
     ============================ */
  const itemsContainer = document.getElementById("items");

  function renderSummaryItem(item) {
    const thumbUrl = getThumbFor(item.id);

    itemsContainer.innerHTML = `
      <div class="item" data-id="${item.id}">
        <div class="thumb"
             aria-hidden="true"
             style="background-image:url('${thumbUrl}');"></div>
        <div>
          <strong>${item.title}</strong>
          <div class="muted">${item.durata}</div>
        </div>
        <div class="price" data-price="${item.prezzo}">
          ${fmtEuro.format(item.prezzo)}
        </div>
      </div>
    `;
  }

  renderSummaryItem(cartItem);

  /* ============================
     CALCOLO PREZZI (SUB / IVA / TOTALE)
     ============================ */
  let discount = 0;

  function recalc() {
    // subtotale (post-sconto, mai sotto zero)
    const sub = Math.max(0, Number(cartItem.prezzo) - Number(discount));

    // IVA al 22%
    const iva = +(sub * 0.22).toFixed(2);

    // totale finale lordo
    const tot = +(sub + iva).toFixed(2);

    document.getElementById("sub").textContent = fmtEuro.format(sub);
    document.querySelector('[aria-labelledby="riepilogo"] #vat').textContent = fmtEuro.format(iva);
    document.getElementById("tot").textContent = fmtEuro.format(tot);
  }

  recalc();

  /* ============================
     GESTIONE COUPON
     ============================ */
  const applyBtn = document.getElementById("apply");
  const couponInput = document.getElementById("coupon");

  applyBtn.addEventListener("click", () => {
    const code = couponInput.value.trim().toUpperCase();
    if (!code) {
      alert("Inserisci un codice.");
      return;
    }

    if (code === "LUMA10") {
      discount = 10;
      alert("Codice valido: ‚Ç¨10 di sconto applicati.");
    } else if (code === "LUMA20") {
      discount = 20;
      alert("Codice valido: ‚Ç¨20 di sconto applicati.");
    } else {
      discount = 0;
      alert("Codice non valido.");
    }

    recalc();
  });

  /* ============================
     BLOCCO/SBLOCCO PAGAMENTO
     ============================ */
  const terms = document.getElementById("accept");
  const payBox = document.getElementById("payBox");
  const payBtn = document.getElementById("payBtn");
  const method = document.getElementById("paymethod");
  const form = document.getElementById("checkoutForm");

  function setPaymentEnabled(enabled) {
    if (enabled) {
      payBox.removeAttribute("disabled");
      payBox.setAttribute("aria-disabled", "false");
      payBtn.disabled = false;
    } else {
      payBox.setAttribute("disabled", "");
      payBox.setAttribute("aria-disabled", "true");
      payBtn.disabled = true;
    }
  }

  // di default: bloccato
  setPaymentEnabled(false);

  terms.addEventListener("change", () => {
    setPaymentEnabled(terms.checked);
  });

  // mostra/nascondi i campi carta
  function toggleCardFields() {
    const show = method.value === "card";
    payBox.querySelectorAll('[data-pay="card"]').forEach(wrapper => {
      wrapper.style.display = show ? "block" : "none";
      const input = wrapper.querySelector("input");
      if (input) {
        input.required = show;
      }
    });
  }

  method.addEventListener("change", toggleCardFields);

  /* ============================
     VALIDAZIONE E "PAGA"
     ============================ */
  function markInvalid(el, invalid) {
    el.setAttribute("aria-invalid", invalid ? "true" : "false");
  }

  form.addEventListener("submit", e => {
    e.preventDefault();
  });

  payBtn.addEventListener("click", () => {
    // Termini accettati?
    if (!terms.checked) {
      alert("Devi accettare i Termini & Condizioni per procedere.");
      return;
    }

    // Validazione campi required del form
    let ok = true;
    form.querySelectorAll("[required]").forEach(el => {
      const valid = el.checkValidity();
      markInvalid(el, !valid);
      if (!valid) ok = false;
    });
    if (!ok) {
      alert("Controlla i campi evidenziati.");
      return;
    }

    // Se metodo carta, controlla carta
    if (method.value === "card") {
      const num = document.getElementById("ccnum").value.replace(/\s+/g, "");
      const exp = document.getElementById("exp").value;
      const cvv = document.getElementById("cvv").value;
      const cardOk =
        num &&
        /^\d{12,19}$/.test(num) &&
        /^(0[1-9]|1[0-2])\/\d{2}$/.test(exp) &&
        /^\d{3,4}$/.test(cvv);

      if (!cardOk) {
        alert("Dati carta non validi.");
        return;
      }
    }

    const totTxt = document.getElementById("tot").textContent;
    alert(
      "Ordine confermato!\n" +
      "Corso: " + cartItem.title + "\n" +
      "Totale: " + totTxt + "\n\n" +
      "Riceverai un‚Äôemail con i dettagli di accesso entro 24 ore."
    );
  });

  /* UX: togli errore appena valido in tempo reale */
  form.addEventListener("input", e => {
    if (e.target.matches("[required]")) {
      markInvalid(e.target, !e.target.checkValidity());
    }
  });
});
</script>
</body>
</html>